#include "InGamePlayScreen.h"

void *const *InGamePlayScreen::__vftable = sapphire::loadVftable<
    "\x48\x8D\x05\x00\x00\x00\x00\x48\x89\x01\x48\xC7\x41\x00\x00\x00\x00\x00\x4C\x89"_sig,
    &InGamePlayScreen::__vftable>();

void InGamePlayScreen::tick(int32_t nTick, int32_t maxTick) {
    using Hook = sapphire::ApiLoader<
        "\x40\x53\x48\x83\xEC\x00\x48\x8B\xD9\x41\x3B\xD0"_sig,
        &InGamePlayScreen::tick>;
    (this->*Hook::origin)(nTick, maxTick);
}

void InGamePlayScreen::applyInput(float a) {
    using Hook = sapphire::ApiLoader<
        "\x48\x8B\xC4\x48\x89\x58\x00\x55\x56\x57\x41\x54\x41\x55\x41\x56\x41\x57\x48\x8D\xA8\x00\x00\x00\x00\x48\x81\xEC\x00\x00\x00\x00\x0F\x29\x70\x00\x0F\x29\x78\x00\x44\x0F\x29\x40\x00\x44\x0F\x28\xC1"_sig,
        &InGamePlayScreen::applyInput>;
    (this->*Hook::origin)(a);
}

void InGamePlayScreen::prepareFrame(ScreenContext &screenContext) {
    using Hook = sapphire::ApiLoader<
#if MC_VERSION == v1_21_2
        "\x48\x89\x5C\x24\x00\x55\x56\x57\x41\x54\x41\x55\x41\x56\x41\x57\x48\x8D\xAC\x24\x20\xFF\x00\x00\x48\x81\xEC\x00\x00\x00\x00\x48\x8B\x05\x00\x00\x00\x00\x48\x33\xC4\x48\x89\x85\x00\x00\x00\x00\x48\x89\x54\x24\x00\x4C\x8B"_sig,
#elif MC_VERSION == v1_21_50 || MC_VERSION == v1_21_60
        "\x48\x89\x5C\x24\x00\x55\x56\x57\x41\x54\x41\x55\x41\x56\x41\x57\x48\x8D\xAC\x24\xD0\xFE\x00\x00\x48\x81\xEC\x00\x00\x00\x00\x48\x8B\x05\x00\x00\x00\x00\x48\x33\xC4\x48\x89\x85\x00\x00\x00\x00\x48\x89\x54\x24\x00\x4C\x8B"_sig,
#endif
        &InGamePlayScreen::prepareFrame>;
    (this->*Hook::origin)(screenContext);
}

void InGamePlayScreen::render(ScreenContext &screenContext, const FrameRenderObject &renderObj) {
    using Hook = sapphire::ApiLoader<
#if MC_VERSION == v1_21_2
        "\x48\x89\x5C\x24\x00\x48\x89\x6C\x24\x00\x48\x89\x74\x24\x00\x57\x41\x56\x41\x57\x48\x83\xEC\x00\x4D\x8B\xF8\x4C\x8B\xF2\x48\x8B\xD9"_sig,
#elif MC_VERSION == v1_21_50 || MC_VERSION == v1_21_60
        "\x48\x89\x5C\x24\x00\x48\x89\x6C\x24\x00\x48\x89\x74\x24\x00\x48\x89\x7C\x24\x00\x41\x54\x41\x56\x41\x57\x48\x83\xEC\x50\x4D\x8B\xE0"_sig,
#endif
        &InGamePlayScreen::render>;
    (this->*Hook::origin)(screenContext, renderObj);
}

void InGamePlayScreen::_pick(float a) {
    using Hook = sapphire::ApiLoader<
        "\x48\x8B\xC4\x48\x89\x58\x00\x55\x56\x57\x41\x54\x41\x55\x41\x56\x41\x57\x48\x8D\xA8\x00\x00\x00\x00\x48\x81\xEC\x00\x00\x00\x00\x0F\x29\x70\x00\x0F\x29\x78\x00\x44\x0F\x29\x40\x00\x44\x0F\x29\x48\x00\x44\x0F\x29\x90\x00\x00\x00\x00\x44\x0F\x29\x98\x00\x00\x00\x00\x44\x0F\x29\xA0\x00\x00\x00\x00\x44\x0F\x29\xA8\x00\x00\x00\x00\x44\x0F\x29\xB0\x00\x00\x00\x00\x44\x0F\x29\xB8\x00\x00\x00\x00\x48\x8B\x05\x00\x00\x00\x00\x48\x33\xC4\x48\x89\x85\x00\x00\x00\x00\x0F\x28\xF1"_sig,
        &InGamePlayScreen::_pick>;
    (this->*Hook::origin)(a);
}